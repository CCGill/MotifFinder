---
title: "MotifFinder: Vignette (Tutorial)"
author: "Daniel Wells"
date: "`r Sys.Date()`"
output: github_document
vignette: >
  %\VignetteIndexEntry{MotifFinder: Vignette (Tutorial)}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include=FALSE}
# rmarkdown::render("vignettes/vignette.Rmd")
devtools::load_all()
library(MotifFinder)
```

```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=10)
```

## Simulate Data
We create 300 DNA sequences of length 200 with the motif "ATgTT_GtCC" around the center of 50% of the sequences.

```{r simulate}
library(MotifFinder)
set.seed(42)
simulated_sequences <- simulate_sequences(motif="ATgTT_GtCC")

str(simulated_sequences)
```

# Run MotifFinder
We run MotifFinder with a length slightly shorter than the known motif length.

```{r findmotif, results='hide'}
motif_found <- findamotif(simulated_sequences, len=7)
```

## Plot the Motif(s) Found
We can see that we have recovered the motif.

```{r plotlogo}
library(ggseqlogo)
ggseqlogo(get_PWM(motif_found))
ggseqlogo(get_PWM(motif_found, complement=TRUE))
```

## Where is the motif
We can also check the location of the motif found.

```{r plotlocation}
plot_motif_location(motif_found)
```


## Check Convergence
It's a good idea to plot the inferred probability the motif being in each sequence (alpha parameter) for each iteration to check convergence.

```{r plotalpha}
plot(motif_found$alphas)
```

Other helper functions include downloading PWMs from the Jaspar or Hocomoco databases.
```{r donwloadPWM}
Ascl2 <- download_PWM("MA0816.1")
str(Ascl2)
```

